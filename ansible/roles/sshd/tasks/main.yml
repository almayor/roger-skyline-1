---
- name: Configure sshd
  become: true
  lineinfile:
    dest: /etc/ssh/sshd_config
    regexp: "{{ item.regexp }}"
    line: "{{ item.line }}"
  with_items:
    - { regexp: '^#?PermitRootLogin\s+=\s+yes',
        line: 'PermitRootLogin = no' }
    - { regexp: '^#?PasswordAuthentication\s+=\s+yes',
        line: 'PasswordAuthentication = no' }
  notify: Restart sshd
